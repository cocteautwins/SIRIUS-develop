\hypertarget{classsirius_1_1_step__function}{}\section{sirius\+:\+:Step\+\_\+function Class Reference}
\label{classsirius_1_1_step__function}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}


Unit step function is defined to be 1 in the interstitial and 0 inside muffin-\/tins.  


\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classsirius_1_1_step__function_a2e2c0019b924cbe20a26323c550c498a}{Step\+\_\+function} (\hyperlink{classsirius_1_1_unit__cell}{Unit\+\_\+cell} const \&unit\+\_\+cell\+\_\+\+\_\+, \hyperlink{classsddk_1_1_f_f_t3_d}{F\+F\+T3\+D} $\ast$fft\+\_\+\+\_\+, \hyperlink{classsddk_1_1_gvec}{Gvec} const \&gvec\+\_\+\+\_\+, \hyperlink{classsddk_1_1_communicator}{Communicator} const \&comm\+\_\+\+\_\+)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{classsddk_1_1mdarray}{mdarray}$<$ double, 2 $>$ \hyperlink{classsirius_1_1_step__function_a60c320f1c66e3033c41f53c25a425c30}{get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors} (int num\+\_\+gsh, \hyperlink{classsirius_1_1_unit__cell}{Unit\+\_\+cell} const \&unit\+\_\+cell\+\_\+\+\_\+, \hyperlink{classsddk_1_1_gvec}{Gvec} const \&gvec\+\_\+\+\_\+, \hyperlink{classsddk_1_1_communicator}{Communicator} const \&comm\+\_\+\+\_\+) const 
\begin{DoxyCompactList}\small\item\em Get $ \Theta(\alpha, G) $ form factors of the step function. \end{DoxyCompactList}\item 
double\+\_\+complex const \& \hyperlink{classsirius_1_1_step__function_a381c98cb82cc4ce2134e936655779727}{theta\+\_\+pw} (int ig\+\_\+\+\_\+) const 
\begin{DoxyCompactList}\small\item\em Return plane-\/wave coefficient of the step function. \end{DoxyCompactList}\item 
double \hyperlink{classsirius_1_1_step__function_a1311008d699b84e87cc76aa17f8c2245}{theta\+\_\+r} (int ir\+\_\+\+\_\+) const 
\begin{DoxyCompactList}\small\item\em Return the value of the step function for the grid point ir. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ double\+\_\+complex $>$ \hyperlink{classsirius_1_1_step__function_a3a57b383d5fb66fefdd153ac94064c9d}{step\+\_\+function\+\_\+pw\+\_\+}
\begin{DoxyCompactList}\small\item\em Plane wave expansion coefficients of the step function. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classsirius_1_1_step__function_a811fd3e1fe15e4e66820cbee8dba05a8}{step\+\_\+function\+\_\+}
\begin{DoxyCompactList}\small\item\em Step function on the real-\/space grid. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Unit step function is defined to be 1 in the interstitial and 0 inside muffin-\/tins. 

Unit step function is constructed from it\textquotesingle{}s plane-\/wave expansion coefficients which are computed analytically\+: \[ \Theta({\bf r}) = \sum_{\bf G} \Theta({\bf G}) e^{i{\bf Gr}}, \] where \[ \Theta({\bf G}) = \frac{1}{\Omega} \int \Theta({\bf r}) e^{-i{\bf Gr}} d{\bf r} = \frac{1}{\Omega} \int_{\Omega} e^{-i{\bf Gr}} d{\bf r} - \frac{1}{\Omega} \int_{MT} e^{-i{\bf Gr}} d{\bf r} = \delta_{\bf G, 0} - \sum_{\alpha} \frac{1}{\Omega} \int_{MT_{\alpha}} e^{-i{\bf Gr}} d{\bf r} \] Integral of a plane-\/wave over the muffin-\/tin volume is taken using the spherical expansion of the plane-\/wave around central point $ \tau_{\alpha} $\+: \[ \int_{MT_{\alpha}} e^{-i{\bf Gr}} d{\bf r} = e^{-i{\bf G\tau_{\alpha}}} \int_{MT_{\alpha}} 4\pi \sum_{\ell m} (-i)^{\ell} j_{\ell}(Gr) Y_{\ell m}(\hat {\bf G}) Y_{\ell m}^{*}(\hat {\bf r}) r^2 \sin \theta dr d\phi d\theta \] In the above integral only $ \ell=m=0 $ term survives. So we have\+: \[ \int_{MT_{\alpha}} e^{-i{\bf Gr}} d{\bf r} = 4\pi e^{-i{\bf G\tau_{\alpha}}} \Theta(\alpha, G) \] where \[ \Theta(\alpha, G) = \int_{0}^{R_{\alpha}} \frac{\sin(Gr)}{Gr} r^2 dr = \left\{ \begin{array}{ll} \displaystyle R_{\alpha}^3 / 3 & G=0 \\ \Big( \sin(GR_{\alpha}) - GR_{\alpha}\cos(GR_{\alpha}) \Big) / G^3 & G \ne 0 \end{array} \right. \] are the so-\/called step function form factors. With this we have a final expression for the plane-\/wave coefficients of the unit step function\+: \[ \Theta({\bf G}) = \delta_{\bf G, 0} - \sum_{\alpha} \frac{4\pi}{\Omega} e^{-i{\bf G\tau_{\alpha}}} \Theta(\alpha, G) \] 

Definition at line 69 of file step\+\_\+function.\+h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classsirius_1_1_step__function_a2e2c0019b924cbe20a26323c550c498a}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!Step\+\_\+function@{Step\+\_\+function}}
\index{Step\+\_\+function@{Step\+\_\+function}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{Step\+\_\+function(\+Unit\+\_\+cell const \&unit\+\_\+cell\+\_\+\+\_\+, F\+F\+T3\+D $\ast$fft\+\_\+\+\_\+, Gvec const \&gvec\+\_\+\+\_\+, Communicator const \&comm\+\_\+\+\_\+)}]{\setlength{\rightskip}{0pt plus 5cm}sirius\+::\+Step\+\_\+function\+::\+Step\+\_\+function (
\begin{DoxyParamCaption}
\item[{{\bf Unit\+\_\+cell} const \&}]{unit\+\_\+cell\+\_\+\+\_\+, }
\item[{{\bf F\+F\+T3\+D} $\ast$}]{fft\+\_\+\+\_\+, }
\item[{{\bf Gvec} const \&}]{gvec\+\_\+\+\_\+, }
\item[{{\bf Communicator} const \&}]{comm\+\_\+\+\_\+}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{classsirius_1_1_step__function_a2e2c0019b924cbe20a26323c550c498a}


Constructor. 



Definition at line 82 of file step\+\_\+function.\+h.



\subsection{Member Function Documentation}
\hypertarget{classsirius_1_1_step__function_a60c320f1c66e3033c41f53c25a425c30}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors@{get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors}}
\index{get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors@{get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors(int num\+\_\+gsh, Unit\+\_\+cell const \&unit\+\_\+cell\+\_\+\+\_\+, Gvec const \&gvec\+\_\+\+\_\+, Communicator const \&comm\+\_\+\+\_\+) const }]{\setlength{\rightskip}{0pt plus 5cm}{\bf mdarray}$<$double, 2$>$ sirius\+::\+Step\+\_\+function\+::get\+\_\+step\+\_\+function\+\_\+form\+\_\+factors (
\begin{DoxyParamCaption}
\item[{int}]{num\+\_\+gsh, }
\item[{{\bf Unit\+\_\+cell} const \&}]{unit\+\_\+cell\+\_\+\+\_\+, }
\item[{{\bf Gvec} const \&}]{gvec\+\_\+\+\_\+, }
\item[{{\bf Communicator} const \&}]{comm\+\_\+\+\_\+}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classsirius_1_1_step__function_a60c320f1c66e3033c41f53c25a425c30}


Get $ \Theta(\alpha, G) $ form factors of the step function. 

\[ \Theta(\alpha, G) = \int_{0}^{R_{\alpha}} \frac{\sin(Gr)}{Gr} r^2 dr = \left\{ \begin{array}{ll} \displaystyle R_{\alpha}^3 / 3 & G=0 \\ \Big( \sin(GR_{\alpha}) - GR_{\alpha}\cos(GR_{\alpha}) \Big) / G^3 & G \ne 0 \end{array} \right. \] 

Definition at line 137 of file step\+\_\+function.\+h.

\hypertarget{classsirius_1_1_step__function_a381c98cb82cc4ce2134e936655779727}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!theta\+\_\+pw@{theta\+\_\+pw}}
\index{theta\+\_\+pw@{theta\+\_\+pw}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{theta\+\_\+pw(int ig\+\_\+\+\_\+) const }]{\setlength{\rightskip}{0pt plus 5cm}double\+\_\+complex const\& sirius\+::\+Step\+\_\+function\+::theta\+\_\+pw (
\begin{DoxyParamCaption}
\item[{int}]{ig\+\_\+\+\_\+}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classsirius_1_1_step__function_a381c98cb82cc4ce2134e936655779727}


Return plane-\/wave coefficient of the step function. 



Definition at line 168 of file step\+\_\+function.\+h.

\hypertarget{classsirius_1_1_step__function_a1311008d699b84e87cc76aa17f8c2245}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!theta\+\_\+r@{theta\+\_\+r}}
\index{theta\+\_\+r@{theta\+\_\+r}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{theta\+\_\+r(int ir\+\_\+\+\_\+) const }]{\setlength{\rightskip}{0pt plus 5cm}double sirius\+::\+Step\+\_\+function\+::theta\+\_\+r (
\begin{DoxyParamCaption}
\item[{int}]{ir\+\_\+\+\_\+}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}\label{classsirius_1_1_step__function_a1311008d699b84e87cc76aa17f8c2245}


Return the value of the step function for the grid point ir. 



Definition at line 175 of file step\+\_\+function.\+h.



\subsection{Member Data Documentation}
\hypertarget{classsirius_1_1_step__function_a3a57b383d5fb66fefdd153ac94064c9d}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!step\+\_\+function\+\_\+pw\+\_\+@{step\+\_\+function\+\_\+pw\+\_\+}}
\index{step\+\_\+function\+\_\+pw\+\_\+@{step\+\_\+function\+\_\+pw\+\_\+}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{step\+\_\+function\+\_\+pw\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$double\+\_\+complex$>$ sirius\+::\+Step\+\_\+function\+::step\+\_\+function\+\_\+pw\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classsirius_1_1_step__function_a3a57b383d5fb66fefdd153ac94064c9d}


Plane wave expansion coefficients of the step function. 



Definition at line 74 of file step\+\_\+function.\+h.

\hypertarget{classsirius_1_1_step__function_a811fd3e1fe15e4e66820cbee8dba05a8}{}\index{sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}!step\+\_\+function\+\_\+@{step\+\_\+function\+\_\+}}
\index{step\+\_\+function\+\_\+@{step\+\_\+function\+\_\+}!sirius\+::\+Step\+\_\+function@{sirius\+::\+Step\+\_\+function}}
\subsubsection[{step\+\_\+function\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$double$>$ sirius\+::\+Step\+\_\+function\+::step\+\_\+function\+\_\+\hspace{0.3cm}{\ttfamily [private]}}\label{classsirius_1_1_step__function_a811fd3e1fe15e4e66820cbee8dba05a8}


Step function on the real-\/space grid. 



Definition at line 77 of file step\+\_\+function.\+h.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{step__function_8h}{step\+\_\+function.\+h}\end{DoxyCompactItemize}
